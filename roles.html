  <script src="roles.js"></script>
  <script>
    // Переменная для хранения текущих отфильтрованных ролей
    let currentFilteredRoles = [];
    
    // Проверяем, загрузились ли роли из внешнего файла
    // Если нет, используем локальный массив
    if (typeof window.roles === 'undefined') {
      console.warn('Роли не загружены из roles.js, используем локальные данные');
      window.roles = [
        {
          name: "Администратор по цифровым технологиям РУ",
          description: "Полный доступ к управлению сервером",
          color: "#ff6b6b",
          gradient: "linear-gradient(135deg, #ff6b6b, #ff4757)",
          category: "Администрация"
        },
        {
          name: "Модератор",
          description: "Контроль порядка на сервере",
          color: "#3498db",
          gradient: "linear-gradient(135deg, #3498db, #2980b9)",
          category: "Администрация"
        },
        {
          name: "Игрок",
          description: "Основная роль для участников",
          color: "#2ecc71",
          gradient: "linear-gradient(135deg, #2ecc71, #27ae60)",
          category: "Основные роли"
        },
        {
          name: "Главный администратор",
          description: "Контроль порядка на сервере",
          color: "#3498db",
          gradient: "linear-gradient(135deg, #3498db, #2980b9)",
          category: "Администрация"
        }
      ];
    }
    
    const roles = window.roles; // Используем глобальные роли

    // Функция для обновления отображения текущей категории
    function updateCurrentCategory(category) {
      const categoryText = document.getElementById('current-category-text');
      const categoryName = category === 'all' ? 'Все' : category;
      categoryText.innerHTML = `Категория: <span class="category-name">${categoryName}</span>`;
    }

    // Функция для обновления статуса сортировки
    function updateSortStatus(sortType) {
      const statusElement = document.getElementById('sort-status');
      let statusText = '';
      
      switch(sortType) {
        case 'alphabetical':
          statusText = 'Алфавитная';
          break;
        case 'reverse':
          statusText = 'Обратная';
          break;
        case 'color':
          statusText = 'По цветам';
          break;
        default:
          statusText = 'Алфавитная';
      }
      
      statusElement.innerHTML = `Сортировка: <span class="status-text">${statusText}</span>`;
    }

    // Функция для сортировки ролей
    function sortRoles(rolesToSort, sortType) {
      const sortedRoles = [...rolesToSort];
      
      switch(sortType) {
        case 'alphabetical':
          return sortedRoles.sort((a, b) => a.name.localeCompare(b.name));
          
        case 'reverse':
          return sortedRoles.sort((a, b) => b.name.localeCompare(a.name));
          
        case 'color':
          return sortedRoles.sort((a, b) => {
            const colorA = parseInt(a.color.replace('#', ''), 16);
            const colorB = parseInt(b.color.replace('#', ''), 16);
            return colorA - colorB;
          });
          
        default:
          return sortedRoles;
      }
    }

    function displayRoles(rolesToDisplay) {
      const rolesList = document.getElementById('roles-list');
      const noResults = document.getElementById('no-results');
      const resultsCount = document.querySelector('#results-count span');
      
      rolesList.innerHTML = '';
      resultsCount.textContent = rolesToDisplay.length;
      
      if (rolesToDisplay.length === 0) {
        noResults.style.display = 'block';
        return;
      }
      
      noResults.style.display = 'none';
      
      rolesToDisplay.forEach(role => {
        const roleCard = document.createElement('div');
        roleCard.className = 'role-card-detailed';
        roleCard.innerHTML = `
          <div class="role-header">
            <span class="role-dot-large" style="background:${role.color}"></span>
            <div class="role-title">${role.name}</div>
            <span class="role-category">${role.category}</span>
          </div>
          <div class="role-description-detailed">
            ${role.description}
          </div>
        `;
        rolesList.appendChild(roleCard);
      });
      
      // Запуск анимации карточек
      setTimeout(animateRoleCards, 100);
    }

    function populateCategories() {
      const categorySelect = document.getElementById('category-select');
      const categories = [...new Set(roles.map(r => r.category))];
      
      while (categorySelect.options.length > 1) {
        categorySelect.remove(1);
      }
      
      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        categorySelect.appendChild(option);
      });
    }

    function filterRoles() {
      const searchTerm = document.getElementById('role-search').value.toLowerCase();
      const selectedCategory = document.getElementById('category-select').value;
      const sortType = document.getElementById('sort-select').value;
      
      updateCurrentCategory(selectedCategory);
      
      let filteredRoles = roles;
      
      if (selectedCategory !== 'all') {
        filteredRoles = filteredRoles.filter(role => role.category === selectedCategory);
      }
      
      if (searchTerm) {
        filteredRoles = filteredRoles.filter(role => 
          role.name.toLowerCase().includes(searchTerm) || 
          role.description.toLowerCase().includes(searchTerm)
        );
      }
      
      currentFilteredRoles = filteredRoles;
      const sortedRoles = sortRoles(currentFilteredRoles, sortType);
      updateSortStatus(sortType);
      displayRoles(sortedRoles);
    }

    function applySorting() {
      const sortType = document.getElementById('sort-select').value;
      
      if (currentFilteredRoles.length === 0) {
        currentFilteredRoles = roles;
      }
      
      const sortedRoles = sortRoles(currentFilteredRoles, sortType);
      updateSortStatus(sortType);
      displayRoles(sortedRoles);
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Запуск анимации заголовков
      setTimeout(() => {
        const pageTitle = document.querySelector('.page-title');
        const pageDesc = document.querySelector('.page-description');
        const currentCategory = document.querySelector('.current-category');
        const sortPanel = document.querySelector('.sort-panel');
        const rolesContainer = document.querySelector('.roles-container');
        
        if (pageTitle) {
          pageTitle.style.opacity = '1';
          pageTitle.style.transform = 'translateY(0)';
        }
        
        if (pageDesc) {
          pageDesc.style.opacity = '1';
          pageDesc.style.transform = 'translateY(0)';
        }
        
        if (currentCategory) {
          currentCategory.style.opacity = '1';
          currentCategory.style.transform = 'translateY(0)';
        }
        
        if (sortPanel) {
          sortPanel.style.opacity = '1';
          sortPanel.style.transform = 'translateY(0)';
        }
        
        if (rolesContainer) {
          rolesContainer.style.opacity = '1';
          rolesContainer.style.transform = 'translateY(0)';
        }
      }, 100);
      
      if (!roles || roles.length === 0) {
        document.getElementById('no-results').style.display = 'block';
        return;
      }
      
      populateCategories();
      updateCurrentCategory('all');
      updateSortStatus('alphabetical');
      currentFilteredRoles = roles;
      
      const sortedRoles = sortRoles(roles, 'alphabetical');
      displayRoles(sortedRoles);
      
      // Обработчики для фильтрации
      document.getElementById('role-search').addEventListener('input', filterRoles);
      document.getElementById('category-select').addEventListener('change', filterRoles);
      
      // Обработчики для сортировки
      document.getElementById('sort-select').addEventListener('change', applySorting);
      
      // Кнопка очистки поиска
      document.getElementById('clear-search').addEventListener('click', function() {
        document.getElementById('role-search').value = '';
        filterRoles();
      });
      
      // Кнопка сброса фильтров
      document.getElementById('reset-filters').addEventListener('click', function() {
        document.getElementById('role-search').value = '';
        document.getElementById('category-select').value = 'all';
        updateCurrentCategory('all');
        filterRoles();
      });
      
      // Кнопка сброса сортировки
      document.getElementById('reset-sort').addEventListener('click', function() {
        document.getElementById('sort-select').value = 'alphabetical';
        updateSortStatus('alphabetical');
        
        if (currentFilteredRoles.length === 0) {
          currentFilteredRoles = roles;
        }
        
        const sortedRoles = sortRoles(currentFilteredRoles, 'alphabetical');
        displayRoles(sortedRoles);
      });
      
      // Мобильное меню
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const navMenu = document.getElementById('nav-menu');
      
      if (mobileMenuBtn) {
        mobileMenuBtn.addEventListener('click', function() {
          navMenu.classList.toggle('active');
          const icon = this.querySelector('i');
          if (navMenu.classList.contains('active')) {
            icon.classList.remove('fa-bars');
            icon.classList.add('fa-times');
          } else {
            icon.classList.remove('fa-times');
            icon.classList.add('fa-bars');
          }
        });
        
        // Закрытие меню при клике на ссылку
        const navLinks = document.querySelectorAll('.nav-menu a');
        navLinks.forEach(link => {
          link.addEventListener('click', function() {
            navMenu.classList.remove('active');
            mobileMenuBtn.querySelector('i').classList.remove('fa-times');
            mobileMenuBtn.querySelector('i').classList.add('fa-bars');
          });
        });
        
        // Закрытие меню при клике вне его
        document.addEventListener('click', function(event) {
          if (!navMenu.contains(event.target) && !mobileMenuBtn.contains(event.target)) {
            navMenu.classList.remove('active');
            mobileMenuBtn.querySelector('i').classList.remove('fa-times');
            mobileMenuBtn.querySelector('i').classList.add('fa-bars');
          }
        });
      }
    });
  </script>
</body>
</html>
