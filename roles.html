<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Справочник ролей - The Outlast Trials RU</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="roles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Навбар -->
  <nav class="navbar">
    <div class="nav-left">
      <div class="logo">
        <img src="logo.png" alt="Логотип" class="logo-img">
        <span class="site-name">The Outlast Trials RU</span>
      </div>
    </div>
    <button class="mobile-menu-btn" id="mobile-menu-btn">
      <i class="fas fa-bars"></i>
    </button>
    <div class="nav-right">
      <ul class="nav-menu" id="nav-menu">
        <li><a href="index.html"><i class="fas fa-home"></i> Главная</a></li>
        <li><a href="roles.html" class="active"><i class="fas fa-users"></i> Справочник ролей</a></li>
        <li><a href="#"><i class="fas fa-info-circle"></i> О нас</a></li>
        <li><a href="#"><i class="fas fa-user"></i> Админ-панель</a></li>
      </ul>
    </div>
  </nav>

  <main class="content">
    <section class="page-header">
      <h1 class="page-title">
        <i class="fas fa-book"></i> Справочник ролей
      </h1>
      <p class="page-description">
        В этом разделе вы можете ознакомиться со всеми ролями нашего сервера Discord.<br>
        Используйте фильтры ниже для поиска нужных ролей по категориям или названиям.
      </p>
    </section>

    <section class="filter-panel">
      <div class="filter-container">
        <div class="search-box">
          <i class="fas fa-search search-icon"></i>
          <input type="text" id="role-search" placeholder="Поиск роли по названию..." class="search-input">
          <button id="clear-search" class="clear-btn" title="Очистить поиск">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="category-filter">
          <label for="category-select" class="filter-label">
            <i class="fas fa-filter"></i> Фильтр по категориям:
          </label>
          <select id="category-select" class="category-select">
            <option value="all">Все категории</option>
          </select>
        </div>

        <div class="filter-actions">
          <button id="reset-filters" class="reset-btn">
            <i class="fas fa-redo"></i> Сбросить фильтры
          </button>
          <span id="results-count" class="results-count">Найдено ролей: <span>0</span></span>
        </div>
      </div>
    </section>

    <!-- Блок отображения текущей категории -->
    <div class="current-category">
      <p id="current-category-text" class="current-category-text">
        Категория: <span class="category-name">Все</span>
      </p>
    </div>

    <!-- Панель сортировки -->
    <section class="sort-panel">
      <div class="sort-container">
        <div class="sort-order">
          <label for="sort-select" class="sort-label">
            <i class="fas fa-sort-amount-down"></i> Сортировать:
          </label>
          <select id="sort-select" class="sort-select">
            <option value="alphabetical">В алфавитном порядке</option>
            <option value="reverse">В обратном порядке</option>
            <option value="color">По цветовой гамме</option>
          </select>
        </div>

        <div class="sort-info">
          <span id="sort-status" class="sort-status">
            Сортировка: <span class="status-text">Алфавитная</span>
          </span>
          <button id="reset-sort" class="sort-reset-btn">
            <i class="fas fa-sync-alt"></i> Сбросить сортировку
          </button>
        </div>
      </div>
    </section>

    <section class="roles-container">
      <div id="roles-list" class="roles-list"></div>
      <div id="no-results" class="no-results" style="display: none;">
        <i class="fas fa-search fa-3x"></i>
        <h3>Роли не найдены</h3>
        <p>Попробуйте изменить параметры поиска или выбрать другую категорию</p>
      </div>
    </section>
  </main>

  <script src="roles.js"></script>
  <script>
    // Данные ролей (пример)
    const roles = [
      { 
        id: 1, 
        name: "Администратор", 
        category: "Администрация", 
        description: "Полный доступ ко всем функциям сервера, управление настройками и пользователями.", 
        color: "#da2b2b" 
      },
      { 
        id: 2, 
        name: "Модератор", 
        category: "Модерация", 
        description: "Отвечает за порядок в чатах, удаляет нарушающие правила сообщения.", 
        color: "#1abc9c" 
      },
      { 
        id: 3, 
        name: "Ивент-менеджер", 
        category: "Организация", 
        description: "Организует и проводит мероприятия, игры и конкурсы на сервере.", 
        color: "#3498db" 
      },
      { 
        id: 4, 
        name: "Хелпер", 
        category: "Помощь", 
        description: "Помогает новым участникам, отвечает на вопросы по серверу.", 
        color: "#f1c40f" 
      },
      { 
        id: 5, 
        name: "Художник", 
        category: "Творчество", 
        description: "Создает графику для сервера: баннеры, иконки, оформление.", 
        color: "#9b59b6" 
      },
      { 
        id: 6, 
        name: "Вещатель", 
        category: "Развлечения", 
        description: "Проводит стримы, делится музыкой и создает развлекательный контент.", 
        color: "#e74c3c" 
      },
      { 
        id: 7, 
        name: "Ветеран", 
        category: "Статус", 
        description: "Участник сервера с долгим сроком пребывания и активным участием.", 
        color: "#95a5a6" 
      },
      { 
        id: 8, 
        name: "Активный участник", 
        category: "Статус", 
        description: "Регулярно участвует в жизни сервера, общается и помогает другим.", 
        color: "#2ecc71" 
      },
      { 
        id: 9, 
        name: "Новичок", 
        category: "Статус", 
        description: "Новый участник сервера, недавно присоединившийся к сообществу.", 
        color: "#e67e22" 
      },
      { 
        id: 10, 
        name: "Разработчик", 
        category: "Технический", 
        description: "Разрабатывает ботов, скрипты и другие технические решения для сервера.", 
        color: "#34495e" 
      },
      { 
        id: 11, 
        name: "Переводчик", 
        category: "Контент", 
        description: "Переводит материалы, новости и другую информацию для сообщества.", 
        color: "#1abc9c" 
      },
      { 
        id: 12, 
        name: "Автор контента", 
        category: "Контент", 
        description: "Создает статьи, гайды, обзоры и другой полезный контент.", 
        color: "#d35400" 
      },
      { 
        id: 13, 
        name: "Элитный игрок", 
        category: "Игроки", 
        description: "Достиг высоких результатов в играх, участвует в турнирах.", 
        color: "#f39c12" 
      },
      { 
        id: 14, 
        name: "Патреон", 
        category: "Поддержка", 
        description: "Финансово поддерживает развитие сервера через Patreon.", 
        color: "#e84393" 
      },
      { 
        id: 15, 
        name: "Друг проекта", 
        category: "Поддержка", 
        description: "Помогает проекту рекомендациями, связями или другими ресурсами.", 
        color: "#0984e3" 
      }
    ];

    // Функция для получения класса цвета на основе шестнадцатеричного значения
    function getColorClass(colorHex) {
      // Преобразуем hex в RGB и определяем цвет
      const hex = colorHex.replace('#', '');
      const r = parseInt(hex.substr(0, 2), 16);
      const g = parseInt(hex.substr(2, 2), 16);
      const b = parseInt(hex.substr(4, 2), 16);
      
      // Определяем наиболее близкий цвет из доступных
      const colorMap = {
        '#ff3333': 'red-dot',
        '#ff9933': 'orange-dot',
        '#ffff33': 'yellow-dot',
        '#33cc33': 'green-dot',
        '#3366ff': 'blue-dot',
        '#9933ff': 'purple-dot',
        '#996633': 'brown-dot',
        '#333333': 'black-dot',
        '#ffffff': 'white-dot',
        '#ff66cc': 'pink-dot',
        '#33ffff': 'cyan-dot',
        '#99ff33': 'lime-dot',
        '#6666ff': 'indigo-dot',
        '#33cccc': 'teal-dot',
        '#ff33cc': 'magenta-dot',
        '#ffcc00': 'gold-dot',
        '#cccccc': 'silver-dot',
        '#ff6666': 'coral-dot',
        '#cc99ff': 'lavender-dot',
        '#33ffcc': 'turquoise-dot',
        '#990000': 'maroon-dot',
        '#999933': 'olive-dot',
        '#000066': 'navy-dot',
        '#da2b2b': 'red-dot',
        '#1abc9c': 'teal-dot',
        '#3498db': 'blue-dot',
        '#f1c40f': 'yellow-dot',
        '#9b59b6': 'purple-dot',
        '#e74c3c': 'red-dot',
        '#95a5a6': 'silver-dot',
        '#2ecc71': 'green-dot',
        '#e67e22': 'orange-dot',
        '#34495e': 'navy-dot',
        '#d35400': 'orange-dot',
        '#f39c12': 'gold-dot',
        '#e84393': 'pink-dot',
        '#0984e3': 'blue-dot'
      };
      
      // Находим ближайший цвет
      let closestColor = 'blue-dot'; // значение по умолчанию
      let minDistance = Infinity;
      
      for (const [hexColor, className] of Object.entries(colorMap)) {
        const hexR = parseInt(hexColor.substr(1, 2), 16);
        const hexG = parseInt(hexColor.substr(3, 2), 16);
        const hexB = parseInt(hexColor.substr(5, 2), 16);
        
        const distance = Math.sqrt(
          Math.pow(r - hexR, 2) + 
          Math.pow(g - hexG, 2) + 
          Math.pow(b - hexB, 2)
        );
        
        if (distance < minDistance) {
          minDistance = distance;
          closestColor = className;
        }
      }
      
      return closestColor;
    }

    // Переменная для хранения текущих отфильтрованных ролей
    let currentFilteredRoles = [];
    
    // Функция для анимации появления карточек ролей
    function animateRoleCards() {
      const roleCards = document.querySelectorAll('.role-card-detailed');
      roleCards.forEach((card, index) => {
        setTimeout(() => {
          card.classList.add('animated');
        }, index * 100);
      });
    }

    // Функция для обновления отображения текущей категории
    function updateCurrentCategory(category) {
      const categoryText = document.getElementById('current-category-text');
      const categoryName = category === 'all' ? 'Все' : category;
      categoryText.innerHTML = `Категория: <span class="category-name">${categoryName}</span>`;
    }

    // Функция для обновления статуса сортировки
    function updateSortStatus(sortType) {
      const statusElement = document.getElementById('sort-status');
      let statusText = '';
      
      switch(sortType) {
        case 'alphabetical':
          statusText = 'Алфавитная';
          break;
        case 'reverse':
          statusText = 'Обратная';
          break;
        case 'color':
          statusText = 'По цветам';
          break;
        default:
          statusText = 'Алфавитная';
      }
      
      statusElement.innerHTML = `Сортировка: <span class="status-text">${statusText}</span>`;
    }

    // Функция для сортировки ролей
    function sortRoles(rolesToSort, sortType) {
      const sortedRoles = [...rolesToSort];
      
      switch(sortType) {
        case 'alphabetical':
          return sortedRoles.sort((a, b) => a.name.localeCompare(b.name));
          
        case 'reverse':
          return sortedRoles.sort((a, b) => b.name.localeCompare(a.name));
          
        case 'color':
          return sortedRoles.sort((a, b) => {
            const colorA = parseInt(a.color.replace('#', ''), 16);
            const colorB = parseInt(b.color.replace('#', ''), 16);
            return colorA - colorB;
          });
          
        default:
          return sortedRoles;
      }
    }

    function displayRoles(rolesToDisplay) {
      const rolesList = document.getElementById('roles-list');
      const noResults = document.getElementById('no-results');
      const resultsCount = document.querySelector('#results-count span');
      
      rolesList.innerHTML = '';
      resultsCount.textContent = rolesToDisplay.length;
      
      if (rolesToDisplay.length === 0) {
        noResults.style.display = 'block';
        return;
      }
      
      noResults.style.display = 'none';
      
      rolesToDisplay.forEach(role => {
        const colorClass = getColorClass(role.color);
        const roleCard = document.createElement('div');
        roleCard.className = 'role-card-detailed';
        roleCard.innerHTML = `
          <div class="role-header">
            <span class="role-dot-large ${colorClass}"></span>
            <div class="role-title">${role.name}</div>
            <span class="role-category">${role.category}</span>
          </div>
          <div class="role-description-detailed">
            ${role.description}
          </div>
        `;
        rolesList.appendChild(roleCard);
      });
      
      // Запуск анимации карточек
      setTimeout(animateRoleCards, 100);
    }

    function populateCategories() {
      const categorySelect = document.getElementById('category-select');
      const categories = [...new Set(roles.map(r => r.category))];
      
      while (categorySelect.options.length > 1) {
        categorySelect.remove(1);
      }
      
      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        categorySelect.appendChild(option);
      });
    }

    function filterRoles() {
      const searchTerm = document.getElementById('role-search').value.toLowerCase();
      const selectedCategory = document.getElementById('category-select').value;
      const sortType = document.getElementById('sort-select').value;
      
      updateCurrentCategory(selectedCategory);
      
      let filteredRoles = roles;
      
      if (selectedCategory !== 'all') {
        filteredRoles = filteredRoles.filter(role => role.category === selectedCategory);
      }
      
      if (searchTerm) {
        filteredRoles = filteredRoles.filter(role => 
          role.name.toLowerCase().includes(searchTerm) || 
          role.description.toLowerCase().includes(searchTerm)
        );
      }
      
      currentFilteredRoles = filteredRoles;
      const sortedRoles = sortRoles(currentFilteredRoles, sortType);
      updateSortStatus(sortType);
      displayRoles(sortedRoles);
    }

    function applySorting() {
      const sortType = document.getElementById('sort-select').value;
      
      if (currentFilteredRoles.length === 0) {
        currentFilteredRoles = roles;
      }
      
      const sortedRoles = sortRoles(currentFilteredRoles, sortType);
      updateSortStatus(sortType);
      displayRoles(sortedRoles);
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Запуск анимации заголовков
      setTimeout(() => {
        const pageTitle = document.querySelector('.page-title');
        const pageDesc = document.querySelector('.page-description');
        const currentCategory = document.querySelector('.current-category');
        const sortPanel = document.querySelector('.sort-panel');
        const rolesContainer = document.querySelector('.roles-container');
        
        if (pageTitle) {
          pageTitle.style.opacity = '1';
          pageTitle.style.transform = 'translateY(0)';
        }
        
        if (pageDesc) {
          pageDesc.style.opacity = '1';
          pageDesc.style.transform = 'translateY(0)';
        }
        
        if (currentCategory) {
          currentCategory.style.opacity = '1';
          currentCategory.style.transform = 'translateY(0)';
        }
        
        if (sortPanel) {
          sortPanel.style.opacity = '1';
          sortPanel.style.transform = 'translateY(0)';
        }
        
        if (rolesContainer) {
          rolesContainer.style.opacity = '1';
          rolesContainer.style.transform = 'translateY(0)';
        }
      }, 100);
      
      if (!roles || roles.length === 0) {
        document.getElementById('no-results').style.display = 'block';
        return;
      }
      
      populateCategories();
      updateCurrentCategory('all');
      updateSortStatus('alphabetical');
      currentFilteredRoles = roles;
      
      const sortedRoles = sortRoles(roles, 'alphabetical');
      displayRoles(sortedRoles);
      
      // Обработчики для фильтрации
      document.getElementById('role-search').addEventListener('input', filterRoles);
      document.getElementById('category-select').addEventListener('change', filterRoles);
      
      // Обработчики для сортировки
      document.getElementById('sort-select').addEventListener('change', applySorting);
      
      // Кнопка очистки поиска
      document.getElementById('clear-search').addEventListener('click', function() {
        document.getElementById('role-search').value = '';
        filterRoles();
      });
      
      // Кнопка сброса фильтров
      document.getElementById('reset-filters').addEventListener('click', function() {
        document.getElementById('role-search').value = '';
        document.getElementById('category-select').value = 'all';
        updateCurrentCategory('all');
        filterRoles();
      });
      
      // Кнопка сброса сортировки
      document.getElementById('reset-sort').addEventListener('click', function() {
        document.getElementById('sort-select').value = 'alphabetical';
        updateSortStatus('alphabetical');
        
        if (currentFilteredRoles.length === 0) {
          currentFilteredRoles = roles;
        }
        
        const sortedRoles = sortRoles(currentFilteredRoles, 'alphabetical');
        displayRoles(sortedRoles);
      });
      
      // Мобильное меню
      const mobileMenuBtn = document.getElementById('mobile-menu-btn');
      const navMenu = document.getElementById('nav-menu');
      
      if (mobileMenuBtn) {
        mobileMenuBtn.addEventListener('click', function() {
          navMenu.classList.toggle('active');
          const icon = this.querySelector('i');
          if (navMenu.classList.contains('active')) {
            icon.classList.remove('fa-bars');
            icon.classList.add('fa-times');
          } else {
            icon.classList.remove('fa-times');
            icon.classList.add('fa-bars');
          }
        });
        
        // Закрытие меню при клике на ссылку
        const navLinks = document.querySelectorAll('.nav-menu a');
        navLinks.forEach(link => {
          link.addEventListener('click', function() {
            navMenu.classList.remove('active');
            mobileMenuBtn.querySelector('i').classList.remove('fa-times');
            mobileMenuBtn.querySelector('i').classList.add('fa-bars');
          });
        });
        
        // Закрытие меню при клике вне его
        document.addEventListener('click', function(event) {
          if (!navMenu.contains(event.target) && !mobileMenuBtn.contains(event.target)) {
            navMenu.classList.remove('active');
            mobileMenuBtn.querySelector('i').classList.remove('fa-times');
            mobileMenuBtn.querySelector('i').classList.add('fa-bars');
          }
        });
      }
    });
  </script>
</body>
</html>
